# Java的平台无关性

Write Once, Run Anywhere.

---

对于Java平台无关性的支持，是分布在整个Java体系结构中的。其中扮演着重要角色的有Java语言规范、Java虚拟机、Class文件等。

计算机并不能直接执行我们编写好的java程序，因为计算机只认识0和1，java程序需要先经过编译才能被计算机执行。

![img](E:\学习笔记\StudyNotes\Java\基础知识\markdown图片\15539284762449.jpg)

在Java中，javac完成前端编译，将.java文件转换成.class文件，jvm完成后端编译，将.class文件转换二进制文件。‘

![img](E:\学习笔记\StudyNotes\Java\基础知识\markdown图片\15539291533175.jpg)

## java虚拟机

对于不同的硬件和操作系统，最主要的区别就是指令不同，想要做到跨平台，最重要的就是根据硬件和操作系统生成对应的二进制指令（就好比一本书想在不同的国家出版，首先需要翻译成不同的语言），而这一工作主要由JVM完成。

**虽然Java语言是平台无关的，但JVM确实是平台有关的。**不同的操作系统需要使用不同的JVM：

![img](E:\学习笔记\StudyNotes\Java\基础知识\markdown图片\15539297082025.jpg)

![img](E:\学习笔记\StudyNotes\Java\基础知识\markdown图片\15539303829914.jpg)

java之所以能实现跨平台，是因为JVM充当了桥梁。

## Class文件（字节码文件）

各种不同的平台的虚拟机都使用统一的程序存储格式——字节码（ByteCode）。字节码是实现Java语言平台无关的另一个基石。JVM只与字节码文件进行交互。

**“Write Once, Run Anywhere”中的Write，指的就是生成Class文件的过程。**

因为Class文件可以在任何平台创建，也可以在任何平台的JVM装载并执行，所以才有了Java的平台无关性。

## Java语言规范

已经有了统一的Class文件，以及可以在不同平台上将Class文件翻译成对应的二进制文件的Java虚拟机，Java就可以彻底实现跨平台了吗？

其实并不是的，Java语言在跨平台方面也是做了一些努力的，这些努力被定义在Java语言规范中。

比如，Java中基本数据类型的值域和行为都是由其自己定义的。而C/C++中，基本数据类型是由它的占位宽度决定的，占位宽度则是由所在平台决定的。所以，在不同的平台中，对于同一个C++程序的编译结果会出现不同的行为。

举一个简单的例子，对于int类型，在Java中，int占4个字节，这是固定的。

但是在C++中却不是固定的了。在16位计算机上，int类型的长度可能为两字节；在32位计算机上，可能为4字节；当64位计算机流行起来后，int类型的长度可能会达到8字节。（这里说的都是可能哦！）

![img](E:\学习笔记\StudyNotes\Java\基础知识\markdown图片\15539319645205.jpg)

通过保证基本数据类型在所有平台的一致性，Java语言为平台无关性提供强了有力的支持。

---

# 语言无关性

其实，Java的无关性不仅仅体现在平台无关性上面，向外扩展一下，Java还具有语言无关性。

前面我们提到过。JVM其实并不是和Java文件进行交互的，而是和Class文件，也就是说，其实JVM运行的时候，并不依赖于Java语言。

时至今日，商业机构和开源机构已经在Java语言之外发展出一大批可以在JVM上运行的语言了，如Groovy、Scala、Jython等。之所以可以支持，就是因为这些语言也可以被编译成字节码（Class文件）。而虚拟机并不关心字节码是有哪种语言编译而来的

---

学习自：https://hollischuang.github.io/toBeTopJavaer/#/basics/object-oriented/platform-independent