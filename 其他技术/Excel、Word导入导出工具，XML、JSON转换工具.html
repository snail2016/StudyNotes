<html><head><meta charset="utf-8"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha256-BZ71u1P7NUocEN9mKkcAovn3q5JPm/r9xVyjWh/Kqrc=" crossorigin="anonymous"><style>.markdown-body hr::after,.markdown-body::after{clear:both}.loopLine,.messageLine0{marker-end:"url(#arrowhead)"}@font-face{font-family:octicons-link;src:url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff')}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";line-height:1.5;word-wrap:break-word}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2::before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body hr::after,.markdown-body hr::before,.markdown-body::after,.markdown-body::before{display:table;content:""}.markdown-body a{background-color:transparent;-webkit-text-decoration-skip:objects;color:#0366d6;text-decoration:none}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body svg:not(:root){overflow:hidden}.markdown-body hr{box-sizing:content-box}.markdown-body input{font:inherit;margin:0;overflow:visible;font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body td,.markdown-body th{padding:0}.markdown-body blockquote{margin:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body .task-list-item,ul.table-of-contents{list-style-type:none}.markdown-body dd{margin-left:0}.markdown-body code{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace}.markdown-body pre{font:12px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;word-wrap:normal}.markdown-body .pl-0{padding-left:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:0}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{overflow:hidden;background:#e1e4e8;height:.25em;padding:0;margin:24px 0;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h6{color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body code{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code::after,.markdown-body code::before{letter-spacing:-.2em;content:"\00a0"}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code::after,.markdown-body pre code::before{content:normal}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-bottom-color:#c6cbd1;border-radius:3px;box-shadow:inset 0 -1px 0 #c6cbd1}.hljs,.katex .katex-html>.newline{display:block}.node text,.noteText,div.mermaidTooltip{font-family:'trebuchet ms',verdana,arial}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown-body hr{border-bottom-color:#eee}.hljs{overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-meta,.hljs-strong{font-weight:700}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.mermaid .label{color:#333}.node circle,.node ellipse,.node polygon,.node rect{fill:#ECECFF;stroke:#CCF;stroke-width:1px}.edgePath .path{stroke:#333}.edgeLabel{background-color:#e8e8e8}.cluster rect{fill:#ffffde!important;rx:4!important;stroke:#aa3!important;stroke-width:1px!important}.cluster text{fill:#333}.actor{stroke:#CCF;fill:#ECECFF}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0,.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#CCF;fill:#ECECFF}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";stroke:#CCF}.note{stroke:#aa3;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-size:14px}.section{stroke:none;opacity:.2}.section0{fill:rgba(102,102,255,.49)}.section2{fill:#fff400}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:#d3d3d3;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#8a90dd;stroke:#534fbc}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#bfc7ff;stroke:#534fbc}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:#d3d3d3;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}.node text{font-size:14px}div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}@font-face{font-family:KaTeX_AMS;font-style:normal;font-weight:400;src:url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"),url(fonts/KaTeX_AMS-Regular.woff) format("woff"),url(fonts/KaTeX_AMS-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"),url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"),url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(fonts/KaTeX_Main-Bold.woff) format("woff"),url(fonts/KaTeX_Main-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(fonts/KaTeX_Main-Italic.woff) format("woff"),url(fonts/KaTeX_Main-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(fonts/KaTeX_Main-Regular.woff) format("woff"),url(fonts/KaTeX_Main-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(fonts/KaTeX_Math-Italic.woff) format("woff"),url(fonts/KaTeX_Math-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_SansSerif;font-style:normal;font-weight:700;src:url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"),url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_SansSerif;font-style:italic;font-weight:400;src:url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"),url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_SansSerif;font-style:normal;font-weight:400;src:url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"),url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Script;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Script-Regular.woff2) format("woff2"),url(fonts/KaTeX_Script-Regular.woff) format("woff"),url(fonts/KaTeX_Script-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size1;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size1-Regular.woff) format("woff"),url(fonts/KaTeX_Size1-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size2;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size2-Regular.woff) format("woff"),url(fonts/KaTeX_Size2-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size3;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size3-Regular.woff) format("woff"),url(fonts/KaTeX_Size3-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size4;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size4-Regular.woff) format("woff"),url(fonts/KaTeX_Size4-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Typewriter;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"),url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"),url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype")}.katex{font:400 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0;text-rendering:auto}.katex .mathit,.katex .textit{font-style:italic}.katex *{-ms-high-contrast-adjust:none!important}.katex .katex-mathml{border:0;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;width:1px}.katex .base{position:relative;white-space:nowrap;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathdefault{font-family:KaTeX_Math;font-style:italic}.katex .mathit{font-family:KaTeX_Main}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-style:italic;font-weight:700}.katex .amsrm,.katex .mathbb,.katex .textbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak,.katex .textfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr,.katex .textscr{font-family:KaTeX_Script}.katex .mathsf,.katex .textsf{font-family:KaTeX_SansSerif}.katex .mathboldsf,.katex .textboldsf{font-family:KaTeX_SansSerif;font-weight:700}.katex .mathitsf,.katex .textitsf{font-family:KaTeX_SansSerif;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{display:inline-table;table-layout:fixed}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;position:relative;vertical-align:bottom}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;font-size:1px;min-width:2px;vertical-align:bottom;width:2px}.katex .clap>.fix,.katex .fontsize-ensurer,.katex .hdashline,.katex .llap>.fix,.katex .mfrac .frac-line,.katex .mspace,.katex .nulldelimiter,.katex .rlap>.fix,.katex .rule,.katex .sizing{display:inline-block}.katex .msupsub{text-align:left}.katex .accent>.vlist-t,.katex .mfrac>span>span,.katex .mtable .col-align-c>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .mfrac .frac-line{border-bottom-style:solid;width:100%}.katex .hdashline,.katex .hline,.katex .mfrac .frac-line,.katex .overline .overline-line,.katex .rule,.katex .underline .underline-line{min-height:1px}.katex .clap,.katex .llap,.katex .rlap{position:relative;width:0}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .accent .accent-body,.katex .delimcenter,.katex .op-symbol,.katex .rule{position:relative}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{border:0 solid}.katex .hline,.katex .overline .overline-line,.katex .underline .underline-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline{border-bottom-style:dashed;width:100%}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.83333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.16666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.66666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.45666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.14666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.85714286em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.46857143em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.96285714em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.55428571em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.66666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.77777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.88888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.30444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.76444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.58333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.66666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72833333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.07333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.41666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.48611111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.55555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.44027778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.72777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.28935185em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.34722222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.40509259em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.46296296em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.52083333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20023148em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.43981481em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.24108004em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.28929605em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.33751205em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.38572806em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.43394407em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48216008em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57859209em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69431051em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.83317261em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.19961427em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.20096463em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.24115756em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.28135048em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.32154341em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.36173633em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.40192926em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.48231511em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.57877814em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.69453376em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.83360129em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{width:.12em}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent .accent-body:not(.accent-full){width:0}.katex .overlay{display:block}.katex .mtable .vertical-separator{border-right:.05em solid;display:inline-block;margin:0 -.025em;min-width:1px}.katex .mtable .vs-dashed{border-right:.05em dashed}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex .mover,.katex .munder,.katex .x-arrow,.katex-display,div[data-role=mermaid]{text-align:center}.katex svg{display:block;fill:currentColor;fill-opacity:1;fill-rule:nonzero;height:inherit;position:absolute;stroke:currentColor;stroke-dasharray:none;stroke-dashoffset:0;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-width:1;width:100%}.katex .hide-tail,.katex .stretchy{overflow:hidden;position:relative;width:100%}.katex svg path{stroke:none}.katex .stretchy{display:block}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .brace-center,.katex .brace-left,.katex .brace-right,.katex .halfarrow-left,.katex .halfarrow-right{position:absolute;overflow:hidden}.katex .halfarrow-left{left:0;width:50.2%}.katex .halfarrow-right{right:0;width:50.2%}.katex .brace-left{left:0;width:25.1%}.katex .brace-center{left:25%;width:50%}.katex .brace-right{right:0;width:25.1%}.katex .x-arrow-pad{padding:0 .5em}.katex .boxpad{padding:0 .3em}.katex .fbox{border:.04em solid #000;box-sizing:border-box}.katex .fcolorbox{border:.04em solid;box-sizing:border-box}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap{margin-left:-.2em;margin-right:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}.katex-display{display:block;margin:1em 0}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}.katex-display>.katex>.katex-html>.tag{position:absolute;right:0}body{margin:0;padding:0}.markdown-body{min-width:256px;max-width:978px;margin:0 auto;padding:20px;font-size:14px}.markdown-body h1{font-size:2.25em}.markdown-body h2{font-size:1.75em}.markdown-body h3{font-size:1.5em}.markdown-body h4{font-size:1.25em}.markdown-body h5,.markdown-body h6{font-size:1em}div[data-role=mermaid] svg{height:auto}hr.footnotes-sep{margin:64px 0 32px;height:1px}.footnotes{font-size:90%;padding-left:16px}li.footnote-item>p{margin:8px 0}.danger,.info,.success,.warning{padding:15px;margin-bottom:20px;border:1px solid transparent;border-radius:4px}.danger>p:last-child,.info>p:last-child,.success>p:last-child,.warning>p:last-child{margin-bottom:0}.success{color:#3c763d;background-color:#dff0d8;border-color:#d6e9c6}.info{color:#31708f;background-color:#d9edf7;border-color:#bce8f1}.warning{color:#8a6d3b;background-color:#fcf8e3;border-color:#faebcc}.danger{color:#a94442;background-color:#f2dede;border-color:#ebccd1}abbr[title]{cursor:help;border-bottom:1px dotted #777}ul.table-of-contents li{margin:4px 0}.markdown-body table{border-spacing:0;border-collapse:collapse;width:auto;display:inline-block;overflow:hidden}.markdown-body table td,.markdown-body table th{word-break:break-all}</style></head><article class="markdown-body" id="preview" data-open-title="Hide Preview" data-closed-title="Show Preview" style="padding-bottom: 781px;"><div><h3 id="前言" data-source-line="1"><a class="markdownIt-Anchor" href="#前言"></a>前言</h3>
<p data-source-line="2">这篇文章可能有点乱（代码太多），但是主要想传递的是介绍几种开发中可能使用到的工具，例如Excel、Word导入导出工具，XML、JSON转换工具，以及对于这几种工具的拓展应用以供参考。</p>
<h3 id="excel-导入导出" data-source-line="4"><a class="markdownIt-Anchor" href="#excel-导入导出"></a>EXCEL 导入导出</h3>
<p data-source-line="5">Excel、word导入导出后端一般有两种选择</p>
<p data-source-line="7">1、Apache poi</p>
<p data-source-line="9">2、Easy poi</p>
<p data-source-line="11">首先介绍一下这两个工具，然后再分享实现自定义配置完成导入Excel的工具开发。</p>
<h4 id="1-apache-poi" data-source-line="12"><a class="markdownIt-Anchor" href="#1-apache-poi"></a>1、Apache poi</h4>
<p data-source-line="14">Apache poi 提供了一套Java操纵Microsoft Documents的API，不仅仅是可以操纵Excel还有Word等，
对于Excel从简单的文本插值、单元格样式到公式都可以操作，功能极其强大。</p>
<blockquote data-source-line="16">
<p><a href="https://poi.apache.org/" target="_blank">官网</a>,<a href="https://www.cnblogs.com/huajiezh/p/5467821.html" target="_blank">推荐教程</a></p>
</blockquote>
<p data-source-line="18"><strong>POI导出案例（用户导入模版）</strong></p>
<p data-source-line="20">效果图
<img data-src="https%3A%2F%2Fimg-blog.csdnimg.cn%2F20200413111704557.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1NDY0MjUz%2Csize_16%2Ccolor_FFFFFF%2Ct_70" alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20200413111704557.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1NDY0MjUz,size_16,color_FFFFFF,t_70&amp;ynotemdtimestamp=1586765592464" data-processed="https%3A%2F%2Fimg-blog.csdnimg.cn%2F20200413111704557.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1NDY0MjUz%2Csize_16%2Ccolor_FFFFFF%2Ct_70">
代码实现</p>
<pre data-source-line="23"><code class="hljs"> <span class="hljs-comment">/**
     * <span class="zh-hans">下载用户导入模版</span>
     *
     * @param response
     * @return
     */</span>
    @Override
    public Message down<span class="hljs-constructor">UserExcelTemplate(HttpServletResponse <span class="hljs-params">response</span>)</span> {
        HSSFWorkbook workbook = <span class="hljs-keyword">new</span> <span class="hljs-constructor">HSSFWorkbook()</span>; <span class="hljs-comment">//<span class="zh-hans">创建</span>excel<span class="zh-hans">文件</span></span>
        List&lt;String&gt; columnNames = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;<span class="hljs-literal">()</span>;
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">账号</span>"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">密码</span>"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">姓名</span>"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">性别</span>(0:<span class="zh-hans">男</span>,1:<span class="zh-hans">女</span>)"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">生日</span>"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">手机号码</span>"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">固话号码</span>"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">邮箱</span>"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">地址</span>"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">备注</span>"</span>);
        columnNames.add(<span class="hljs-string">"<span class="zh-hans">部门</span>"</span>);
        HSSFSheet sheet = workbook.create<span class="hljs-constructor">Sheet(<span class="hljs-string">"<span class="zh-hans">用户导入模版</span>"</span>)</span>;  <span class="hljs-comment">//<span class="zh-hans">创建</span>sheet</span>
        HSSFRow titleRow = sheet.create<span class="hljs-constructor">Row(0)</span>;
        HSSFCell titleCell = titleRow.create<span class="hljs-constructor">Cell(0)</span>;
        titleCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"<span class="zh-hans">用户信息导入模板</span>"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">合并单元格</span></span>
        CellRangeAddress region = <span class="hljs-keyword">new</span> <span class="hljs-constructor">CellRangeAddress(0, 0, 0, 10)</span>;
        sheet.add<span class="hljs-constructor">MergedRegion(<span class="hljs-params">region</span>)</span>;
        
        <span class="hljs-comment">//<span class="zh-hans">设置标题文本居中</span></span>
        HSSFCellStyle CenterStyle = workbook.create<span class="hljs-constructor">CellStyle()</span>;
        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CenterStyle</span>.</span></span>set<span class="hljs-constructor">Alignment(HorizontalAlignment.CENTER)</span>;
        titleCell.set<span class="hljs-constructor">CellStyle(CenterStyle)</span>;

        HSSFRow filedRow = sheet.create<span class="hljs-constructor">Row(1)</span>;
        <span class="hljs-comment">//<span class="zh-hans">创建表头</span></span>
        for (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; columnNames.size<span class="hljs-literal">()</span>; i++) {
            HSSFCell columnNameCell = filedRow.create<span class="hljs-constructor">Cell(<span class="hljs-params">i</span>)</span>;
            columnNameCell.set<span class="hljs-constructor">CellStyle(CenterStyle)</span>;
            columnNameCell.set<span class="hljs-constructor">CellValue(<span class="hljs-params">columnNames</span>.<span class="hljs-params">get</span>(<span class="hljs-params">i</span>)</span>);
        }

        <span class="hljs-comment">//<span class="zh-hans">获取下拉选项数据源</span></span>
        String<span class="hljs-literal">[]</span> options = get<span class="hljs-constructor">AllDepartments(<span class="hljs-params">true</span>)</span>.key<span class="hljs-constructor">Set()</span>.stream<span class="hljs-literal">()</span>.sorted(String::compareTo).<span class="hljs-keyword">to</span><span class="hljs-constructor">Array(String[]::<span class="hljs-params">new</span>)</span>;

        HSSFSheet hiddenSheet = workbook.create<span class="hljs-constructor">Sheet(<span class="hljs-string">"hiddenSheet"</span>)</span>;  <span class="hljs-comment">//<span class="zh-hans">创建隐藏</span>sheet</span>
        for (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>, length = options.length; i &lt; length; i++) { <span class="hljs-comment">// <span class="zh-hans">循环赋值（为了防止下拉框的行数与隐藏域的行数相对应来获取</span>&gt;=<span class="zh-hans">选中行数的数组，将隐藏域加到结束行之后）</span></span>
            hiddenSheet.create<span class="hljs-constructor">Row(<span class="hljs-params">i</span>)</span>.create<span class="hljs-constructor">Cell(0)</span>.set<span class="hljs-constructor">CellValue(<span class="hljs-params">options</span>[<span class="hljs-params">i</span>])</span>;
        }
        Name namedCell = workbook.create<span class="hljs-constructor">Name()</span>;
        namedCell.set<span class="hljs-constructor">NameName(<span class="hljs-string">"hiddenSheet"</span>)</span>;
        <span class="hljs-built_in">int</span> length = options.length<span class="hljs-operator"> == </span><span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : options.length;
        <span class="hljs-comment">//<span class="zh-hans">创建公式将部门信息列可选项指向隐藏</span>Sheet<span class="zh-hans">的相关信息列</span></span>
        namedCell.set<span class="hljs-constructor">RefersToFormula(<span class="hljs-string">"hiddenSheet!$A$1:$A$"</span> + <span class="hljs-params">length</span>)</span>;
        DVConstraint <span class="hljs-keyword">constraint</span> = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DVConstraint</span>.</span></span>create<span class="hljs-constructor">FormulaListConstraint(<span class="hljs-string">"hiddenSheet"</span>)</span>;
        CellRangeAddressList addressList = <span class="hljs-keyword">new</span> <span class="hljs-constructor">CellRangeAddressList(1, 65535, 10, 10)</span>;
        HSSFDataValidation validation = <span class="hljs-keyword">new</span> <span class="hljs-constructor">HSSFDataValidation(<span class="hljs-params">addressList</span>, <span class="hljs-params">constraint</span>)</span>;
        sheet.add<span class="hljs-constructor">ValidationData(<span class="hljs-params">validation</span>)</span>;
        workbook.set<span class="hljs-constructor">SheetHidden(1, <span class="hljs-params">true</span>)</span>;

        HSSFRow templateRow = sheet.create<span class="hljs-constructor">Row(2)</span>;

        <span class="hljs-comment">//<span class="zh-hans">账号</span></span>
        HSSFCell accountCell = templateRow.create<span class="hljs-constructor">Cell(0)</span>;
        accountCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"zhangsan"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">密码</span></span>
        HSSFCell pwdCell = templateRow.create<span class="hljs-constructor">Cell(1)</span>;
        pwdCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"Abc123456"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">姓名</span></span>
        HSSFCell nameCell = templateRow.create<span class="hljs-constructor">Cell(2)</span>;
        nameCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"<span class="zh-hans">张三</span>"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">性别</span></span>
        HSSFCell sexCell = templateRow.create<span class="hljs-constructor">Cell(3)</span>;
        sexCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"0"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">生日</span></span>
        HSSFCell birthdayCell = templateRow.create<span class="hljs-constructor">Cell(4)</span>;
        birthdayCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"2019/3/10"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">手机号码</span></span>
        HSSFCell mobilePhoneCell = templateRow.create<span class="hljs-constructor">Cell(5)</span>;
        mobilePhoneCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"18023040023"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">固话号码</span></span>
        HSSFCell cellPhoneCell = templateRow.create<span class="hljs-constructor">Cell(6)</span>;
        cellPhoneCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"10086"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">邮箱</span></span>
        HSSFCell mailCell = templateRow.create<span class="hljs-constructor">Cell(7)</span>;
        mailCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"1234567890@qq.com"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">地址</span></span>
        HSSFCell addressCell = templateRow.create<span class="hljs-constructor">Cell(8)</span>;
        addressCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"<span class="zh-hans">厦门市湖里区高崎机场</span>"</span>)</span>;
        <span class="hljs-comment">//<span class="zh-hans">备注</span></span>
        HSSFCell remarkCell = templateRow.create<span class="hljs-constructor">Cell(9)</span>;
        remarkCell.set<span class="hljs-constructor">CellValue(<span class="hljs-string">"<span class="zh-hans">无</span>"</span>)</span>;
        <span class="hljs-keyword">try</span> {
            download(workbook, <span class="hljs-string">"<span class="zh-hans">用户导入模版</span>"</span>, response);
        } catch (IOException e) {
            return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Message</span>.</span></span>fail(<span class="hljs-string">"<span class="zh-hans">模版导出失败</span>"</span>);
        }
        return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Message</span>.</span></span>ok<span class="hljs-literal">()</span>;
    }

    <span class="hljs-comment">/**
     * <span class="zh-hans">下载</span>
     *
     * @param workbook
     * @param fileName
     * @param response
     * @throws IOException
     */</span>
    <span class="hljs-keyword">private</span> void download(Workbook workbook, String fileName, HttpServletResponse response) throws IOException {
        OutputStream output = null;
        output = response.get<span class="hljs-constructor">OutputStream()</span>;
        response.reset<span class="hljs-literal">()</span>;
        response.set<span class="hljs-constructor">Header(<span class="hljs-string">"Content-disposition"</span>, <span class="hljs-string">"attachment; filename="</span> + URLEncoder.<span class="hljs-params">encode</span>(<span class="hljs-params">fileName</span> + <span class="hljs-string">".xls"</span>, <span class="hljs-string">"UTF-8"</span>)</span>);
        response.set<span class="hljs-constructor">ContentType(<span class="hljs-string">"application/vnd.ms-excel;charset=utf-8"</span>)</span>;
        response.set<span class="hljs-constructor">CharacterEncoding(<span class="hljs-string">"utf-8"</span>)</span>;
        workbook.write(output);
        output.flush<span class="hljs-literal">()</span>;   <span class="hljs-comment">//<span class="zh-hans">这一步至关重要，否则提示文件损坏</span></span>
    }
</code></pre><p data-source-line="144"><strong>POI导入</strong></p>
<p data-source-line="146">POI导入操作API和导出类似，重要的是找到目标行、目标列读取数据就可以了，虽然POI功能虽然强大，数据读取自然不是问题，但是对于简单的Excel数据读取POI显得不那么方便，不如EasyPoi来的简洁，因为EasyPoi对一般的导入/导出做了封装。</p>
<h4 id="2-easypoi" data-source-line="148"><a class="markdownIt-Anchor" href="#2-easypoi"></a>2、 EasyPoi</h4>
<p data-source-line="149">EasyPoi 基于 Apache Poi做了技术封装，开发人员只需要少数几行代码就可以完成Excel的导入导出;虽然使用简单，但是功能也很简单，无法实现apache poi那般强大的功能。</p>
<p data-source-line="151">EasyPOI提供了以下Excel导入导出方式</p>
<ol data-source-line="153">
<li>Java 注解形式;</li>
<li>Excel 模版形式；</li>
</ol>
<p data-source-line="156"><a href="http://easypoi.mydoc.io/#category_50222" target="_blank">官方使用文档</a></p>
<p data-source-line="158">这里介绍注解形式，模版形式诸多不便，还要在服务端存储Excel模版</p>
<p data-source-line="160"><strong>EasyPoi 导入 案例</strong></p>
<pre data-source-line="161"><code class="hljs">ImportParams params = <span class="hljs-keyword">new</span> <span class="hljs-constructor">ImportParams()</span>;
params.set<span class="hljs-constructor">TitleRows(1)</span>;  <span class="hljs-comment">//<span class="zh-hans">标题行数</span></span>
params.set<span class="hljs-constructor">HeadRows(1)</span>;  <span class="hljs-comment">//<span class="zh-hans">表头行数</span></span>
List&lt;OrganizationInfoVo&gt; organizationInfoVoList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;<span class="hljs-literal">()</span>;
<span class="hljs-keyword">try</span> {
    organizationInfoVoList = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ExcelImportUtil</span>.</span></span>import<span class="hljs-constructor">Excel(<span class="hljs-params">file</span>.<span class="hljs-params">getInputStream</span>()</span>, <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">OrganizationInfoVo</span>.</span></span><span class="hljs-keyword">class</span>, params);<span class="hljs-comment">//<span class="zh-hans">导入</span></span>
} catch (Exception e) {
    return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Message</span>.</span></span>fail(<span class="hljs-string">"<span class="zh-hans">导入失败</span>"</span>);
}
</code></pre><pre data-source-line="173"><code class="hljs"><span class="hljs-selector-tag">package</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.pantech</span><span class="hljs-selector-class">.cloud</span><span class="hljs-selector-class">.base</span><span class="hljs-selector-class">.admin</span><span class="hljs-selector-class">.entity</span><span class="hljs-selector-class">.vo</span>;


<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">cn</span><span class="hljs-selector-class">.afterturn</span><span class="hljs-selector-class">.easypoi</span><span class="hljs-selector-class">.excel</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Excel</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">lombok</span><span class="hljs-selector-class">.Data</span>;

<span class="hljs-comment">/**
 * <span class="zh-hans">用户部门分配</span>excel<span class="zh-hans">导入类</span>
 */</span>
@<span class="hljs-keyword">Data</span>
public class OrganizationInfoVo {
    @<span class="hljs-keyword">Excel</span>(<span class="hljs-keyword">name</span> = <span class="hljs-string">"<span class="zh-hans">账号</span>"</span>, orderNum = <span class="hljs-string">"0"</span>)
    private String username;

    @<span class="hljs-keyword">Excel</span>(<span class="hljs-keyword">name</span> = <span class="hljs-string">"<span class="zh-hans">部门</span>"</span>, orderNum = <span class="hljs-string">"1"</span>)
    private String department;
}

</code></pre><blockquote data-source-line="193">
<p>这里的OrganizationInfoVo也可用Map替代</p>
</blockquote>
<p data-source-line="195"><strong>EasyPoi 导出 案例</strong></p>
<pre data-source-line="196"><code class="hljs">ExportParams params = <span class="hljs-keyword">new</span> <span class="hljs-constructor">ExportParams(<span class="hljs-string">"<span class="zh-hans">用户信息表</span>"</span>, <span class="hljs-string">"<span class="zh-hans">用户</span>"</span>)</span>;
Workbook workbook = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ExcelExportUtil</span>.</span></span>export<span class="hljs-constructor">Excel(<span class="hljs-params">params</span>, User.<span class="hljs-params">class</span>, <span class="hljs-params">userList</span>)</span>;
<span class="hljs-keyword">try</span> {
    download(workbook, <span class="hljs-string">"<span class="zh-hans">用户信息表</span>"</span>, response);
} catch (IOException e) {
    return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Message</span>.</span></span>fail(<span class="hljs-string">"<span class="zh-hans">用户导入失败</span>"</span>);
}
</code></pre><pre data-source-line="205"><code class="hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> User <span class="hljs-keyword">implements</span> Serializable {

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> id;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">账号</span>"</span>, orderNum = <span class="hljs-string">"0"</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> username;

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> password;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">姓名</span>"</span>, orderNum = <span class="hljs-string">"1"</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> name;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">生日</span>"</span>, exportFormat = <span class="hljs-string">"yyyy/MM/dd"</span>, orderNum = <span class="hljs-string">"3"</span>, width = <span class="hljs-number">30</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Date</span> birthday;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">地址</span>"</span>, orderNum = <span class="hljs-string">"7"</span>, width = <span class="hljs-number">40</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> address;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">手机号码</span>"</span>, orderNum = <span class="hljs-string">"4"</span>, width = <span class="hljs-number">25</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> mobilePhone;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">固话号码</span>"</span>, orderNum = <span class="hljs-string">"5"</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> telPhone;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">邮箱</span>"</span>, orderNum = <span class="hljs-string">"6"</span>, width = <span class="hljs-number">35</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> email;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">性别</span>"</span>, orderNum = <span class="hljs-string">"2"</span>, width = <span class="hljs-number">15</span>, replace = {<span class="hljs-string">"<span class="zh-hans">男</span>_0"</span>, <span class="hljs-string">"<span class="zh-hans">女</span>_1"</span>})
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> gender;

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> <span class="hljs-keyword">type</span>;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">备注</span>"</span>, orderNum = <span class="hljs-string">"8"</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> remark;

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> isDeleted;

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> isDisabled;

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> departId = <span class="hljs-string">""</span>;

    <span class="hljs-meta">@Excel</span>(name = <span class="hljs-string">"<span class="zh-hans">部门</span>"</span>, orderNum = <span class="hljs-string">"9"</span>, width = <span class="hljs-number">30</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> department;

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> List&lt;<span class="hljs-built_in">String</span>&gt; organizationIdList;

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> isSuperAdmin;

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> tenantId;

    <span class="hljs-comment">//<span class="zh-hans">创建人</span></span>
    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> createBy;

    <span class="hljs-comment">//<span class="zh-hans">创建时间</span></span>
    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Date</span> createTime;

    <span class="hljs-comment">//<span class="zh-hans">最后更新人</span></span>
    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> updateBy;

    <span class="hljs-comment">//<span class="zh-hans">最后更新时间</span></span>
    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Date</span> updateTime;

    <span class="hljs-meta">@ExcelIgnore</span>
    <span class="hljs-keyword">private</span> int errCount;
}
</code></pre><h4 id="自定义配置实现通用excel导入工具" data-source-line="286"><a class="markdownIt-Anchor" href="#自定义配置实现通用excel导入工具"></a>自定义配置，实现通用Excel导入工具</h4>
<p data-source-line="287"><strong>目标</strong>: 实现自定义配置的形式，实现Excel导入并归置Excel内容到类属性。</p>
<p data-source-line="289">这里为了应付复杂的情况所以采用apache poi 作为底层支持。</p>
<p data-source-line="291">配置设计如下</p>
<pre data-source-line="292"><code class="hljs">{
    <span class="hljs-string">"titleRows"</span>: <span class="hljs-string">"1"</span>,   //<span class="zh-hans">标题行数</span>
    <span class="hljs-string">"headRows"</span>: <span class="hljs-string">"1"</span>,   //<span class="zh-hans">表头行数</span>
    <span class="hljs-string">"details"</span>: [
        {
            <span class="hljs-string">"column"</span>: <span class="hljs-string">"0"</span>,
            <span class="hljs-string">"target"</span>: <span class="hljs-string">"flight"</span>,
            <span class="hljs-string">"originSplit"</span>: <span class="hljs-string">"2-6|2-5"</span>,
            <span class="hljs-string">"emptyFillLast"</span>: <span class="hljs-literal">true</span>
        },
        {
            <span class="hljs-string">"column"</span>: <span class="hljs-string">"0"</span>,
            <span class="hljs-string">"target"</span>: <span class="hljs-string">"iataCarrier"</span>,
            <span class="hljs-string">"originSplit"</span>: <span class="hljs-string">"0-2"</span>,
            <span class="hljs-string">"emptyFillLast"</span>: <span class="hljs-literal">true</span>
        },
        {
            <span class="hljs-string">"column"</span>: <span class="hljs-string">"4"</span>,
            <span class="hljs-string">"target"</span>: <span class="hljs-string">"registration"</span>
        },
        {
            <span class="hljs-string">"column"</span>: <span class="hljs-string">"3"</span>,
            <span class="hljs-string">"target"</span>: <span class="hljs-string">"aircraftType"</span>
        },
        {
            <span class="hljs-string">"column"</span>: <span class="hljs-string">"1"</span>,
            <span class="hljs-string">"target"</span>: <span class="hljs-string">"originCn"</span>
        },
        {
            <span class="hljs-string">"column"</span>: <span class="hljs-string">"5"</span>,
            <span class="hljs-string">"target"</span>: <span class="hljs-string">"destinationCn"</span>
        },
        {
            <span class="hljs-string">"column"</span>: <span class="hljs-string">"2"</span>,
            <span class="hljs-string">"target"</span>: <span class="hljs-string">"scheduleDepartTime"</span>,
            <span class="hljs-string">"originDateFormat"</span>: <span class="hljs-string">"HHmm"</span>,
            <span class="hljs-string">"isDefaultDate"</span>: <span class="hljs-literal">true</span>
        },
        {
            <span class="hljs-string">"column"</span>: <span class="hljs-string">"6"</span>,
            <span class="hljs-string">"target"</span>: <span class="hljs-string">"scheduleArriveTime"</span>,
            <span class="hljs-string">"originDateFormat"</span>: <span class="hljs-string">"HHmm"</span>,
            <span class="hljs-string">"isDefaultDate"</span>: <span class="hljs-literal">true</span>
        }
    ]
}
</code></pre><p data-source-line="340">这是一份日计划导入Excel配置，其主要描述的是<mark>Excel列表中那一列对应Java类中的哪个属性</mark>，其他的都是拓展属性，例如</p>
<pre data-source-line="341"><code class="hljs">{
    <span class="hljs-attr">"column"</span>: <span class="hljs-string">"5"</span>,
    <span class="hljs-attr">"target"</span>: <span class="hljs-string">"destinationCn"</span>
}
</code></pre><p data-source-line="347">这个描述的是Excel的第5列，导入后数据对应放置在类中的destinationCn属性上。</p>
<p data-source-line="349">具体的导入案例</p>
<pre data-source-line="350"><code class="hljs">List&lt;FlightSchedulePlan&gt; flightSchedulePlans = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ExcelUtils</span>.</span></span>import<span class="hljs-constructor">Excel(<span class="hljs-params">file</span>, <span class="hljs-params">config</span>, FlightSchedulePlan.<span class="hljs-params">class</span>)</span>;
</code></pre><blockquote data-source-line="353">
<p>file：excel文件，config：上述配置，FlightSchedulePlan.class ： excel数据读取转换成的类</p>
</blockquote>
<p data-source-line="355">这行代码就完成了Excel数据的导入，至于配置可以存储在一个地方，如果只是偶尔用一下，可以自己用代码构造然后转换成一个JSON String就可以了。</p>
<p data-source-line="357"><strong>解析流程图</strong></p>
<div data-source-line="358" data-role="mermaid" data-src="graph%20TD%0AA(%E5%BC%80%E5%A7%8B)%20--%3EB%5B%E6%A0%B9%E6%8D%AEExcel%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%B0%BF%5D%0AB%20--%3E%20C%5B%E8%8E%B7%E5%8F%96Sheet%5D%0AC%20--%3E%20D%5B%E6%A0%B9%E6%8D%AE%E9%85%8D%E7%BD%AE%E6%89%BE%E5%88%B0Excel%E4%B8%AD%E6%9C%89%E6%95%88%E6%95%B0%E6%8D%AE%5D%0AD%20--%3E%20E%5B%E8%AF%BB%E5%8F%96%E8%A1%8C%5D%0AE%20--%3E%20F%5B%E8%AF%BB%E5%8F%96%E5%88%97%5D%0AF%20--%3E%20G%5B%E8%AE%B0%E5%BD%95%E5%88%97%E6%95%B0%E6%8D%AE%5D%0AG%20--%3E%20H%7B%E6%9C%80%E5%90%8E%E4%B8%80%E5%88%97%3F%7D%0AH%20--%3E%20%7C%E5%90%A6%7CF%0AH%20--%3E%20%7C%E6%98%AF%7CI%5B%E8%AE%B0%E5%BD%95%E8%A1%8C%E6%95%B0%E6%8D%AE%5D%0AI%20--%3E%20J%7B%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C%3F%7D%0AJ%20--%3E%20%7C%E5%90%A6%7CE%0AJ%20--%3E%20%7C%E6%98%AF%7CK%5B%E8%AE%B0%E5%BD%95%E8%A1%8C%E6%95%B0%E6%8D%AE%5D%0AK%20--%3E%20L%5B%E5%B0%86%E8%A7%A3%E6%9E%90%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%E9%80%90%E8%A1%8C%E9%80%90%E5%88%97%E6%A0%B9%E6%8D%AE%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%94%BE%E7%BD%AE%E5%88%B0%E7%9B%AE%E6%A0%87%E5%B1%9E%E6%80%A7%5D%0AL%20--%3E%20M(%E7%BB%93%E6%9D%9F)%0A" data-processed="true" data-processed-src="graph%20TD%0AA(%E5%BC%80%E5%A7%8B)%20--%3EB%5B%E6%A0%B9%E6%8D%AEExcel%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%B0%BF%5D%0AB%20--%3E%20C%5B%E8%8E%B7%E5%8F%96Sheet%5D%0AC%20--%3E%20D%5B%E6%A0%B9%E6%8D%AE%E9%85%8D%E7%BD%AE%E6%89%BE%E5%88%B0Excel%E4%B8%AD%E6%9C%89%E6%95%88%E6%95%B0%E6%8D%AE%5D%0AD%20--%3E%20E%5B%E8%AF%BB%E5%8F%96%E8%A1%8C%5D%0AE%20--%3E%20F%5B%E8%AF%BB%E5%8F%96%E5%88%97%5D%0AF%20--%3E%20G%5B%E8%AE%B0%E5%BD%95%E5%88%97%E6%95%B0%E6%8D%AE%5D%0AG%20--%3E%20H%7B%E6%9C%80%E5%90%8E%E4%B8%80%E5%88%97%3F%7D%0AH%20--%3E%20%7C%E5%90%A6%7CF%0AH%20--%3E%20%7C%E6%98%AF%7CI%5B%E8%AE%B0%E5%BD%95%E8%A1%8C%E6%95%B0%E6%8D%AE%5D%0AI%20--%3E%20J%7B%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C%3F%7D%0AJ%20--%3E%20%7C%E5%90%A6%7CE%0AJ%20--%3E%20%7C%E6%98%AF%7CK%5B%E8%AE%B0%E5%BD%95%E8%A1%8C%E6%95%B0%E6%8D%AE%5D%0AK%20--%3E%20L%5B%E5%B0%86%E8%A7%A3%E6%9E%90%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%E9%80%90%E8%A1%8C%E9%80%90%E5%88%97%E6%A0%B9%E6%8D%AE%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%94%BE%E7%BD%AE%E5%88%B0%E7%9B%AE%E6%A0%87%E5%B1%9E%E6%80%A7%5D%0AL%20--%3E%20M(%E7%BB%93%E6%9D%9F)%0A"><svg id="mermaidChart2" width="403" xmlns="http://www.w3.org/2000/svg" height="1354" viewBox="0 0 423 1374"><style type="text/css" title="mermaid-svg-internal-css">/*  */
#mermaidChart2 .node&gt;rect { ; }
#mermaidChart2 .node text  { fill:#000; stroke:none; font-weight:300; font-family:"Helvetica Neue",Helvetica,Arial,sans-serf; font-size:14px; }
#mermaidChart2 .edgeLabel text  { fill:#000; stroke:none; font-weight:300; font-family:"Helvetica Neue",Helvetica,Arial,sans-serf; font-size:14px; }
#mermaidChart2 .cluster rect  { rx:4px; fill: rgb(255, 255, 222); rx: 4px; stroke: rgb(170, 170, 51); stroke-width: 1px; }
.markdown-body * { box-sizing: border-box;}
.node rect, .node circle, .node ellipse, .node polygon { fill: rgb(236, 236, 255); stroke: rgb(204, 204, 255); stroke-width: 1px;}
.edgePath .path { stroke: rgb(51, 51, 51);}
.edgeLabel { background-color: rgb(232, 232, 232);}
/*  */
</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M201.5,61L201.5,86L201.5,111" marker-end="url(#arrowhead266)" style="fill:none"></path><defs><marker id="arrowhead266" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M201.5,152L201.5,177L201.5,202" marker-end="url(#arrowhead267)" style="fill:none"></path><defs><marker id="arrowhead267" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M201.5,243L201.5,268L201.5,293" marker-end="url(#arrowhead268)" style="fill:none"></path><defs><marker id="arrowhead268" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M201.5,334L201.5,359L201.5,384" marker-end="url(#arrowhead269)" style="fill:none"></path><defs><marker id="arrowhead269" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M182.35164835164835,425L159,450L159,475" marker-end="url(#arrowhead270)" style="fill:none"></path><defs><marker id="arrowhead270" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M139.28846153846155,516L115.25,541L115.25,566" marker-end="url(#arrowhead271)" style="fill:none"></path><defs><marker id="arrowhead271" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M115.25,607L115.25,642.5L142.57543520309477,695.4245647969052" marker-end="url(#arrowhead272)" style="fill:none"></path><defs><marker id="arrowhead272" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M176.42456479690523,695.4245647969052L202.75,642.5L202.75,586.5L202.75,541L178.71153846153845,516" marker-end="url(#arrowhead273)" style="fill:none"></path><defs><marker id="arrowhead273" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.5,778.5L159,813.5L159,849" marker-end="url(#arrowhead274)" style="fill:none"></path><defs><marker id="arrowhead274" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159,890L159,915L183.91489361702128,958.5851063829788" marker-end="url(#arrowhead275)" style="fill:none"></path><defs><marker id="arrowhead275" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M223.6446124763705,962.1446124763705L258.75,915L258.75,869.5L258.75,813.5L258.75,728L258.75,642.5L258.75,586.5L258.75,541L258.75,495.5L258.75,450L227.29395604395603,425" marker-end="url(#arrowhead276)" style="fill:none"></path><defs><marker id="arrowhead276" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M202,1040.5L201.5,1075.5L201.5,1111" marker-end="url(#arrowhead277)" style="fill:none"></path><defs><marker id="arrowhead277" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M201.5,1152L201.5,1177L201.5,1202" marker-end="url(#arrowhead278)" style="fill:none"></path><defs><marker id="arrowhead278" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M201.5,1243L201.5,1268L201.5,1293" marker-end="url(#arrowhead279)" style="fill:none"></path><defs><marker id="arrowhead279" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(202.75,586.5)" style="opacity: 1;"><g transform="translate(-7,-10.5)" class="label"><foreignObject width="14" height="21"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">否</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(159,813.5)" style="opacity: 1;"><g transform="translate(-7,-10.5)" class="label"><foreignObject width="14" height="21"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">是</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(258.75,642.5)" style="opacity: 1;"><g transform="translate(-7,-10.5)" class="label"><foreignObject width="14" height="21"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">否</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(201.5,1075.5)" style="opacity: 1;"><g transform="translate(-7,-10.5)" class="label"><foreignObject width="14" height="21"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">是</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node" id="A" transform="translate(201.5,40.5)" style="opacity: 1;"><rect rx="5" ry="5" x="-24.5" y="-20.5" width="49" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-14.5,-10.5)"><foreignObject width="29" height="21"><div style="display: inline-block; white-space: nowrap;">开始</div></foreignObject></g></g></g><g class="node" id="B" transform="translate(201.5,131.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-77" y="-20.5" width="154" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-67,-10.5)"><foreignObject width="134" height="21"><div style="display: inline-block; white-space: nowrap;">根据Excel创建工作簿</div></foreignObject></g></g></g><g class="node" id="C" transform="translate(201.5,222.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-43" y="-20.5" width="86" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-33,-10.5)"><foreignObject width="66" height="21"><div style="display: inline-block; white-space: nowrap;">获取Sheet</div></foreignObject></g></g></g><g class="node" id="D" transform="translate(201.5,313.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-105.5" y="-20.5" width="211" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-95.5,-10.5)"><foreignObject width="191" height="21"><div style="display: inline-block; white-space: nowrap;">根据配置找到Excel中有效数据</div></foreignObject></g></g></g><g class="node" id="E" transform="translate(201.5,404.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-31.5" y="-20.5" width="63" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-21.5,-10.5)"><foreignObject width="43" height="21"><div style="display: inline-block; white-space: nowrap;">读取行</div></foreignObject></g></g></g><g class="node" id="F" transform="translate(159,495.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-31.5" y="-20.5" width="63" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-21.5,-10.5)"><foreignObject width="43" height="21"><div style="display: inline-block; white-space: nowrap;">读取列</div></foreignObject></g></g></g><g class="node" id="G" transform="translate(115.25,586.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-45.5" y="-20.5" width="91" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-35.5,-10.5)"><foreignObject width="71" height="21"><div style="display: inline-block; white-space: nowrap;">记录列数据</div></foreignObject></g></g></g><g class="node" id="H" transform="translate(159,728)" style="opacity: 1;"><polygon points="50,0 100,-50 50,-100 0,-50" rx="5" ry="5" transform="translate(-50,50)"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-32,-10.5)"><foreignObject width="64" height="21"><div style="display: inline-block; white-space: nowrap;">最后一列?</div></foreignObject></g></g></g><g class="node" id="I" transform="translate(159,869.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-45.5" y="-20.5" width="91" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-35.5,-10.5)"><foreignObject width="71" height="21"><div style="display: inline-block; white-space: nowrap;">记录行数据</div></foreignObject></g></g></g><g class="node" id="J" transform="translate(201.5,990)" style="opacity: 1;"><polygon points="50,0 100,-50 50,-100 0,-50" rx="5" ry="5" transform="translate(-50,50)"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-32,-10.5)"><foreignObject width="64" height="21"><div style="display: inline-block; white-space: nowrap;">最后一行?</div></foreignObject></g></g></g><g class="node" id="K" transform="translate(201.5,1131.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-45.5" y="-20.5" width="91" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-35.5,-10.5)"><foreignObject width="71" height="21"><div style="display: inline-block; white-space: nowrap;">记录行数据</div></foreignObject></g></g></g><g class="node" id="L" transform="translate(201.5,1222.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-181.5" y="-20.5" width="363" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-171.5,-10.5)"><foreignObject width="343" height="21"><div style="display: inline-block; white-space: nowrap;">将解析后的数据逐行逐列根据配置信息放置到目标属性</div></foreignObject></g></g></g><g class="node" id="M" transform="translate(201.5,1313.5)" style="opacity: 1;"><rect rx="5" ry="5" x="-24.5" y="-20.5" width="49" height="41"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-14.5,-10.5)"><foreignObject width="29" height="21"><div style="display: inline-block; white-space: nowrap;">结束</div></foreignObject></g></g></g></g></g></g></svg></div><p data-source-line="377"><strong>导入代码实现</strong></p>
<pre data-source-line="378"><code class="hljs"><span class="hljs-comment">/**
     * @param inputStream <span class="zh-hans">输入流</span>
     * @param config      <span class="zh-hans">配置文件</span>
     * @param pojoClass   <span class="zh-hans">目标数据类型</span>
     * @param targetDate  <span class="zh-hans">目标日期</span>
     * @return <span class="zh-hans">返回目标数据</span>
     * @throws RuntimeException
     */</span>
    public static &lt;T&gt; List&lt;T&gt; import<span class="hljs-constructor">Excel(InputStream <span class="hljs-params">inputStream</span>, String <span class="hljs-params">config</span>, Class&lt;T&gt; <span class="hljs-params">pojoClass</span>, String <span class="hljs-params">suffix</span>, Date <span class="hljs-params">targetDate</span>)</span> throws RuntimeException, IOException {
        <span class="hljs-comment">//<span class="zh-hans">解析结果</span></span>
        List&lt;T&gt; resultList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;<span class="hljs-literal">()</span>;
        <span class="hljs-comment">//<span class="zh-hans">根据</span>excel<span class="zh-hans">文件类型创建工作薄</span></span>
        Workbook workbook = null;
        <span class="hljs-keyword">if</span> (suffix.equals(PoiConstant.EXCEL_XLS_SUFFIX)) {
            workbook = <span class="hljs-keyword">new</span> <span class="hljs-constructor">HSSFWorkbook(<span class="hljs-params">inputStream</span>)</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (suffix.equals(PoiConstant.EXCEL_XLSX_SUFFIX)) {
            workbook = <span class="hljs-keyword">new</span> <span class="hljs-constructor">XSSFWorkbook(<span class="hljs-params">inputStream</span>)</span>;
        }

        <span class="hljs-keyword">if</span> (workbook<span class="hljs-operator"> == </span>null) {
            throw <span class="hljs-keyword">new</span> <span class="hljs-constructor">RuntimeException(<span class="hljs-string">"<span class="zh-hans">工作薄为空</span>"</span>)</span>;
        }

        <span class="hljs-comment">//<span class="zh-hans">取工作薄第一页</span>sheet</span>
        Sheet sheet = workbook.get<span class="hljs-constructor">SheetAt(0)</span>;

        <span class="hljs-comment">//<span class="zh-hans">解析配置</span></span>
        ImportConfig importConfig = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JSONObject</span>.</span></span>parse<span class="hljs-constructor">Object(<span class="hljs-params">config</span>, ImportConfig.<span class="hljs-params">class</span>)</span>;

        <span class="hljs-comment">//<span class="zh-hans">获取解析详情（第几列对应哪个属性）</span></span>
        List&lt;ImportConfigDetail&gt; details = importConfig.get<span class="hljs-constructor">Details()</span>;

        <span class="hljs-comment">//index - target Map <span class="zh-hans">同一列可以分割出好几个属性值，这里根据列分组解析配置</span></span>
        Map&lt;String, List&lt;ImportConfigDetail&gt;&gt; indexTargetListMap = details.stream<span class="hljs-literal">()</span>.collect(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Collectors</span>.</span></span>grouping<span class="hljs-constructor">By(ImportConfigDetail::<span class="hljs-params">getColumn</span>)</span>);

        <span class="hljs-comment">//<span class="zh-hans">第一行</span>  <span class="zh-hans">排除标题行数和表头行数找到真正的数据内容</span></span>
        <span class="hljs-built_in">int</span> firstRowNum = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Integer</span>.</span></span>parse<span class="hljs-constructor">Int(<span class="hljs-params">importConfig</span>.<span class="hljs-params">getTitleRows</span>()</span>) + <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Integer</span>.</span></span>parse<span class="hljs-constructor">Int(<span class="hljs-params">importConfig</span>.<span class="hljs-params">getHeadRows</span>()</span>);
        <span class="hljs-comment">//<span class="zh-hans">获取</span>Excel<span class="zh-hans">最后一行</span> </span>
        <span class="hljs-built_in">int</span> lastRowNum = sheet.get<span class="hljs-constructor">LastRowNum()</span>;

        <span class="hljs-comment">//<span class="zh-hans">解析结果</span></span>
        List&lt;Map&lt;String, String&gt;&gt; parseResults = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;<span class="hljs-literal">()</span>;

        <span class="hljs-comment">//<span class="zh-hans">逐行读取</span> </span>
        for (<span class="hljs-built_in">int</span> i = firstRowNum; i &lt;= lastRowNum; i++) {
            <span class="hljs-comment">//<span class="zh-hans">读取行</span></span>
            Row row = sheet.get<span class="hljs-constructor">Row(<span class="hljs-params">i</span>)</span>;
            <span class="hljs-keyword">if</span> (row<span class="hljs-operator"> == </span>null) {
                continue;
            }
            <span class="hljs-comment">//<span class="zh-hans">最后一列</span></span>
            <span class="hljs-built_in">int</span> columnNum = row.get<span class="hljs-constructor">LastCellNum()</span>;

            <span class="hljs-comment">//<span class="zh-hans">行数据</span></span>
            Map&lt;String, String&gt; rowDataMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;<span class="hljs-literal">()</span>;

            <span class="hljs-comment">//<span class="zh-hans">逐列读取</span></span>
            for (<span class="hljs-built_in">int</span> j = <span class="hljs-number">0</span>; j &lt; columnNum; j++) {
                Cell cell = row.get<span class="hljs-constructor">Cell(<span class="hljs-params">j</span>)</span>;
                <span class="hljs-keyword">if</span> (cell<span class="hljs-operator"> == </span>null) {
                    continue;
                }
                <span class="hljs-comment">//<span class="zh-hans">记录</span> <span class="zh-hans">这行</span> <span class="zh-hans">每一列的内容</span> </span>
                rowDataMap.put(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">String</span>.</span></span>value<span class="hljs-constructor">Of(<span class="hljs-params">j</span>)</span>, get<span class="hljs-constructor">CellStringValue(<span class="hljs-params">cell</span>)</span>);
            }
            <span class="hljs-comment">//<span class="zh-hans">记录每一行的数据</span></span>
            parseResults.add(rowDataMap);
        }

        <span class="hljs-comment">/**
        * parseResults
        *<span class="zh-hans">中记录的是每一行的每一列的具体内容，我们配置文件中的哪一列对应哪个属相匹配，这里我们就要将具体的内容赋值到对应的属性上</span>
        */</span>
        <span class="hljs-comment">//<span class="zh-hans">数据解析</span></span>
        for (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; parseResults.size<span class="hljs-literal">()</span>; i++) {

            Map&lt;String, String&gt; parseResult = parseResults.get(i);

            <span class="hljs-keyword">if</span> (parseResult<span class="hljs-operator"> == </span>null<span class="hljs-operator"> || </span>parseResult.is<span class="hljs-constructor">Empty()</span>) {
                continue;
            }

            Map&lt;String, Object&gt; entityMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;<span class="hljs-literal">()</span>;
            for (Map.Entry&lt;String, String&gt; entry : parseResult.entry<span class="hljs-constructor">Set()</span>) {
                <span class="hljs-comment">//<span class="zh-hans">列</span></span>
                String index = entry.get<span class="hljs-constructor">Key()</span>;
                <span class="hljs-comment">//<span class="zh-hans">属性值</span></span>
                String value = entry.get<span class="hljs-constructor">Value()</span>;

                <span class="hljs-comment">//<span class="zh-hans">列解析详情</span></span>
                List&lt;ImportConfigDetail&gt; importConfigDetails = indexTargetListMap.get(index);

                <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CollectionUtils</span>.</span></span>is<span class="hljs-constructor">Empty(<span class="hljs-params">importConfigDetails</span>)</span>) {
                    continue;
                }

                for (ImportConfigDetail importConfigDetail : importConfigDetails) {

                    <span class="hljs-comment">//<span class="zh-hans">如果值为空并且配置有继承上一列表的值则赋值</span></span>
                    <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">StringUtils</span>.</span></span>is<span class="hljs-constructor">Blank(<span class="hljs-params">value</span>)</span><span class="hljs-operator"> &amp;&amp; </span>importConfigDetail.get<span class="hljs-constructor">EmptyFillLast()</span> != null<span class="hljs-operator"> &amp;&amp; </span>importConfigDetail.get<span class="hljs-constructor">EmptyFillLast()</span>) {
                        Map&lt;String, String&gt; lastData = i<span class="hljs-operator"> == </span><span class="hljs-number">0</span> ? <span class="hljs-keyword">new</span> HashMap&lt;&gt;<span class="hljs-literal">()</span> : parseResults.get(i - <span class="hljs-number">1</span>);
                        value = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Optional</span>.</span></span><span class="hljs-keyword">of</span><span class="hljs-constructor">Nullable(<span class="hljs-params">lastData</span>.<span class="hljs-params">get</span>(<span class="hljs-params">index</span>)</span>).<span class="hljs-keyword">or</span><span class="hljs-constructor">Else(<span class="hljs-string">""</span>)</span>;
                        entry.set<span class="hljs-constructor">Value(<span class="hljs-params">value</span>)</span>;
                    }

                    <span class="hljs-comment">//<span class="zh-hans">目标属性类型</span></span>
                    String target = importConfigDetail.get<span class="hljs-constructor">Target()</span>;

                    <span class="hljs-comment">//<span class="zh-hans">源日期格式</span></span>
                    String originDateFormat = importConfigDetail.get<span class="hljs-constructor">OriginDateFormat()</span>;

                    <span class="hljs-comment">//<span class="zh-hans">如果为空表示不是日期类型</span></span>
                    <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">StringUtils</span>.</span></span>is<span class="hljs-constructor">Blank(<span class="hljs-params">originDateFormat</span>)</span>) {
                        <span class="hljs-comment">//<span class="zh-hans">获取源数据分割规则</span></span>
                        String splitRule = importConfigDetail.get<span class="hljs-constructor">OriginSplit()</span>;
                        <span class="hljs-comment">//<span class="zh-hans">如果源数据需要被分割</span></span>
                        <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">StringUtils</span>.</span></span>is<span class="hljs-constructor">NotBlank(<span class="hljs-params">splitRule</span>)</span>) {
                            String<span class="hljs-literal">[]</span> rules = splitRule.split(<span class="hljs-string">"\\|"</span>);
                            for (String rule : rules) {
                                String<span class="hljs-literal">[]</span> indexes = rule.split(<span class="hljs-string">"-"</span>);
                                <span class="hljs-keyword">if</span> (value.length<span class="hljs-literal">()</span> &gt;= <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Integer</span>.</span></span>parse<span class="hljs-constructor">Int(<span class="hljs-params">indexes</span>[1])</span>) {
                                    entityMap.put(target, value.substring(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Integer</span>.</span></span>parse<span class="hljs-constructor">Int(<span class="hljs-params">indexes</span>[0])</span>, <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Integer</span>.</span></span>parse<span class="hljs-constructor">Int(<span class="hljs-params">indexes</span>[1])</span>));
                                    break;
                                }
                            }
                        } <span class="hljs-keyword">else</span> {
                            entityMap.put(target, value);
                        }
                        continue;
                    }
                    <span class="hljs-comment">//<span class="zh-hans">日期格式</span></span>
                    SimpleDateFormat simpleDateFormat = <span class="hljs-keyword">new</span> <span class="hljs-constructor">SimpleDateFormat(<span class="hljs-params">originDateFormat</span>)</span>;

                    <span class="hljs-keyword">try</span> {
                        Date date = simpleDateFormat.parse(value);

                        <span class="hljs-comment">//<span class="zh-hans">日期后缀</span></span>
                        String dateSuffix = <span class="hljs-string">""</span>;
                        <span class="hljs-keyword">if</span> (value.ends<span class="hljs-constructor">With(<span class="hljs-string">"+"</span>)</span>) {
                            dateSuffix = <span class="hljs-string">"+"</span>;
                        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value.ends<span class="hljs-constructor">With(<span class="hljs-string">"-"</span>)</span>) {
                            dateSuffix = <span class="hljs-string">"-"</span>;
                        }

                        <span class="hljs-comment">//<span class="zh-hans">是否需要填充默认的时间</span></span>
                        <span class="hljs-keyword">if</span> (importConfigDetail.get<span class="hljs-constructor">DefaultDate()</span> != null<span class="hljs-operator"> &amp;&amp; </span>importConfigDetail.get<span class="hljs-constructor">DefaultDate()</span>) {
                            entityMap.put(target, set<span class="hljs-constructor">DefaultDate(<span class="hljs-params">date</span>, <span class="hljs-params">targetDate</span>, <span class="hljs-params">dateSuffix</span>)</span>);
                        } <span class="hljs-keyword">else</span> {
                            entityMap.put(target, date);
                        }
                    } catch (ParseException e) {
                        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(<span class="hljs-string">"<span class="zh-hans">解析异常：</span>"</span> + value);
                    }

                }
            }
            resultList.add(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JSONObject</span>.</span></span>parse<span class="hljs-constructor">Object(JSONObject.<span class="hljs-params">toJSONString</span>(<span class="hljs-params">entityMap</span>)</span>, pojoClass));
        }

        return resultList;
    }
</code></pre><hr>
<h3 id="xml-json-相互转换" data-source-line="544"><a class="markdownIt-Anchor" href="#xml-json-相互转换"></a>XML-JSON 相互转换</h3>
<p data-source-line="545"><strong>目标</strong>：实现XML-JSON两种格式的数据过滤、转换、重组。</p>
<p data-source-line="547"><strong>XML 解析工具</strong></p>
<ul data-source-line="548">
<li>XStream</li>
</ul>
<blockquote data-source-line="549">
<p>提供了Java 注解和功能api的形式实现XML解析</p>
</blockquote>
<ul data-source-line="550">
<li>Jackson-dataformat-xml</li>
</ul>
<blockquote data-source-line="551">
<p>提供了功能API形式的XML解析</p>
</blockquote>
<ul data-source-line="552">
<li>dom4j</li>
</ul>
<blockquote data-source-line="553">
<p>功能强大，但也是最复杂的解析工具</p>
</blockquote>
<p data-source-line="555"><strong>JSON 解析工具</strong></p>
<ul data-source-line="556">
<li>Jackson</li>
<li>fastjson</li>
</ul>
<blockquote data-source-line="558">
<p>这两种大家都很熟悉了</p>
</blockquote>
<p data-source-line="560"><strong>设计理念</strong></p>
<ol data-source-line="562">
<li>设计一种配置，实现获取源数据的定位、目标数据的定位以及格式转换配置；</li>
<li>有了源数据的定位就需要获取源数据，所以这里不管是JSON还是XML 这边统一使用工具解析成Java Map 的形式便于获取源数据用于解析;</li>
<li>转换解析后的数据还是用Map 存储，最后根据配置将Map 转换成 XML还是JSON格式；</li>
</ol>
<blockquote data-source-line="566">
<p>这样做的好处是只需要实现一套代码就可以完成JSON-XML的两两互转。</p>
</blockquote>
<p data-source-line="568">设计中的第一步这里就不再细说了，参考:</p>
<pre data-source-line="569"><code class="hljs"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/10.1.16.11/svn</span><span class="hljs-regexp">/Pantech-Acdm/doc</span><span class="hljs-regexp">/CMMI/</span><span class="hljs-number">03</span> <span class="zh-hans">工程类</span>/<span class="hljs-number">02</span> <span class="zh-hans">系统设计编码</span>/<span class="zh-hans">详细设计</span>/<span class="zh-hans">报文解析工具详细设计</span>/<span class="zh-hans">配置文件设计及案例说明</span>.html
</code></pre><p data-source-line="573">这里给出一份解析配置</p>
<pre data-source-line="574"><code class="hljs">{
    <span class="hljs-string">"routingKey"</span>: <span class="hljs-string">"SCHEDULE.FLIGHTSCHEDULE.MF.MFBroker"</span>,
    <span class="hljs-string">"transform"</span>: {
      <span class="hljs-string">"from"</span>: <span class="hljs-string">"XML"</span>,  //xml <span class="zh-hans">转</span> json
      <span class="hljs-string">"to"</span>: <span class="hljs-string">"JSON"</span>,
      <span class="hljs-string">"isWithList"</span>: <span class="hljs-string">"true"</span>,  //xml<span class="zh-hans">中带有列表</span>
      <span class="hljs-string">"details"</span>: [
        {
          <span class="hljs-string">"origin"</span>: <span class="hljs-string">"${false}"</span>,//<span class="zh-hans">无中生有，直接构造一个数据放在目标数据上，源数据就是</span><span class="hljs-literal">false</span>
          <span class="hljs-string">"target"</span>: <span class="hljs-string">"RESULT.DATA.FLIGHTID.ISMATCHFLIGHTID"</span>  //<span class="zh-hans">将目标数据放在</span>map<span class="zh-hans">的这个结构下</span>
        },
        {
          <span class="hljs-string">"origin"</span>: <span class="hljs-string">"${FLIGHTPLAN}"</span>,//<span class="zh-hans">源数据就是</span>FLIGHTPLAN<span class="zh-hans">字符串</span>
          <span class="hljs-string">"target"</span>: <span class="hljs-string">"RESULT.DATA.FLIGHTID.MAINTYPE"</span>
        },
        {
          <span class="hljs-string">"origin"</span>: <span class="hljs-string">"${DAILYPLAN}"</span>,
          <span class="hljs-string">"target"</span>: <span class="hljs-string">"RESULT.DATA.FLIGHTID.SUBTYPE"</span>
        },
        {
          <span class="hljs-string">"origin"</span>: <span class="hljs-string">"${DAILYPLAN}"</span>,
          <span class="hljs-string">"target"</span>: <span class="hljs-string">"RESULT.TYPE"</span>
        },
        {
          <span class="hljs-string">"originType"</span>: <span class="hljs-string">"List"</span>,   //xml<span class="zh-hans">列表解析配置</span>
          <span class="hljs-string">"targetType"</span>: <span class="hljs-string">"List"</span>,
          <span class="hljs-string">"origin"</span>: <span class="hljs-string">"AIIS.FLIGHTSCHEDULE.SCHEDULETFLIGHTS.SCHEDULETFLIGHT"</span>,
          <span class="hljs-string">"target"</span>: <span class="hljs-string">"RESULT.DATA.FLIGHTSEGMENTS"</span>,
          <span class="hljs-string">"details"</span>: [
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.FLIGHTTASK"</span>, //<span class="zh-hans">源数据定位</span>
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.flightTask"</span>  //<span class="zh-hans">目标数据定位</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.CARRIER"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.carrier"</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.FLIGHT"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.flight"</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.ORIGIN"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.origin"</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.DESTINATION"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.destination"</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.REGISTRATION"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.registration"</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.AIRCRAFTTYPE"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.aircraftType"</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.FLIGHTNATURE"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.flightNature"</span>
            },
            {
              <span class="hljs-string">"originType"</span>: <span class="hljs-string">"Date"</span>,  //<span class="zh-hans">源数据格式</span>
              <span class="hljs-string">"targetType"</span>: <span class="hljs-string">"Date"</span>, //<span class="zh-hans">目标数据格式</span>
              <span class="hljs-string">"originDateFormat"</span>: <span class="hljs-string">"yyyyMMddHHmmss"</span>,//<span class="zh-hans">源日期格式</span>
              <span class="hljs-string">"targetDateFormat"</span>: <span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>,  //<span class="zh-hans">目标日期格式</span>
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.SCHEDULEDEPARTURETIME"</span>,  //<span class="zh-hans">源数据定位</span>
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.scheduleDepartTime"</span>  //<span class="zh-hans">目标数据定位</span>
            },
            {
              <span class="hljs-string">"originType"</span>: <span class="hljs-string">"Date"</span>,
              <span class="hljs-string">"targetType"</span>: <span class="hljs-string">"Date"</span>,
              <span class="hljs-string">"originDateFormat"</span>: <span class="hljs-string">"yyyyMMddHHmmss"</span>,
              <span class="hljs-string">"targetDateFormat"</span>: <span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>,
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.SCHEDULEARRIVALTIME"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.scheduleArriveTime"</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"SCHEDULETFLIGHT.GENERALAGENT"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.generalagent"</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"${MF}"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.planSource"</span>
            },
            {
              <span class="hljs-string">"origin"</span>: <span class="hljs-string">"${}"</span>,
              <span class="hljs-string">"target"</span>: <span class="hljs-string">"flightSegment.airportCode"</span>
            }
          ]
        }
      ]
    }
  }
</code></pre><p data-source-line="671">接下来就要选工具了</p>
<p data-source-line="673">XML解析工具刚开始的时候选用的是XStream，这个工具不但可以解析XML还可以解析JSON，简直是全能的，但是这个东西对于我的设计不匹配。</p>
<blockquote data-source-line="674">
<p>这也是个坑点</p>
</blockquote>
<p data-source-line="676">例如：Map转 XML的时候</p>
<pre data-source-line="677"><code class="hljs">Map&lt;<span class="hljs-keyword">String</span>, Object&gt; <span class="hljs-built_in">map</span> = <span class="hljs-keyword">new</span> HashMap();
<span class="hljs-built_in">map</span>.<span class="hljs-built_in">put</span>(<span class="hljs-string">"name"</span>,<span class="hljs-string">"zhangsan"</span>);
<span class="hljs-built_in">map</span>.<span class="hljs-built_in">put</span>(<span class="hljs-string">"age"</span>, <span class="hljs-number">12</span>);
</code></pre><p data-source-line="682">我想象的样子:</p>
<pre data-source-line="683"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-name">map</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>zhangsan<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>12<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">map</span>&gt;</span>
</code></pre><p data-source-line="689">实际上：</p>
<pre data-source-line="690"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-name">map</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">entry</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>name<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>zhangsan<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">entry</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">entry</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>age<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">int</span>&gt;</span>12<span class="hljs-tag">&lt;/<span class="hljs-name">int</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">entry</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">map</span>&gt;</span>
</code></pre><p data-source-line="703">不行不行，没法用，放弃！</p>
<p data-source-line="705">最后选择了Jackson-dataformat-xml，不愧是Spring认可的xml解析工具，和我想象的一摸一样。</p>
<p data-source-line="707">但是还是有坑点，对于带有列表的xml转换成java Map的时候Map中只保留了列表中的最后一项数据，因为是列表中的xml节点标签名字是一样的，所以解析结果是覆盖式的，没法全部解析出来。</p>
<p data-source-line="709">例如XML数据如下</p>
<pre data-source-line="710"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>zhangsan<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>&gt;
	<span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>12<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">friends</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">friend</span>&gt;</span>
			<span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>lisi<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>&gt;
			<span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>13<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">friend</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">friend</span>&gt;</span>
			<span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>wangwu<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>&gt;
			<span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>14<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">friend</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">friends</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span>
</code></pre><p data-source-line="728">使用Jackson-dataformat-xml解析后的数据如下</p>
<pre data-source-line="729"><code class="hljs">{
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"zhangsan"</span>,
  <span class="hljs-attr">"age"</span>: <span class="hljs-string">"12"</span>,
  <span class="hljs-attr">"friends"</span>: {
    <span class="hljs-attr">"friend"</span>: {
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"wangwu"</span>,
      <span class="hljs-attr">"age"</span>: <span class="hljs-string">"14"</span>
    }
  }
}
</code></pre><p data-source-line="741">少了一段数据有没有？lisi没了！！</p>
<p data-source-line="743"><mark>注意：</mark> 这里指的是XML转成MAP才会有这个问题，如果转化成一个指定的类就不会出现这样的问题</p>
<p data-source-line="746">所以此处引入了dom4j这个强大又复杂的解析工具，来自己实现带有列表的xml数据解析。</p>
<p data-source-line="748">代码如下：</p>
<pre data-source-line="749"><code class="hljs"><span class="hljs-comment">/***
     * dom4j <span class="zh-hans">解析带有列表的</span>xml
     * xml<span class="zh-hans">格式字符串转换为</span>map,<span class="zh-hans">相同节点同样被解析出来</span>
     * @param xml xml<span class="zh-hans">字符串</span>
     * @return <span class="zh-hans">第一个为</span>Root<span class="zh-hans">节点，</span>Root<span class="zh-hans">节点之后为</span>Root<span class="zh-hans">的元素，如果为多层，可以通过</span>key<span class="zh-hans">获取下一层</span>Map
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map&lt;<span class="hljs-keyword">String</span>, <span class="hljs-keyword">Object</span>&gt; dom4jXmlToMap(<span class="hljs-keyword">String</span> xml) {
        <span class="hljs-keyword">if</span> (StringUtils.isBlank(xml)) <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
        Document doc = <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">try</span> {
            doc = DocumentHelper.parseText(xml);
        } <span class="hljs-keyword">catch</span> (DocumentException e) {
            e.printStackTrace();
        }
        Map&lt;<span class="hljs-keyword">String</span>, <span class="hljs-keyword">Object</span>&gt; <span class="hljs-built_in">map</span> = <span class="hljs-keyword">new</span> <span class="hljs-keyword">HashMap</span>&lt;&gt;();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == doc) {
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">map</span>;
        }
        <span class="hljs-comment">// <span class="zh-hans">获取根元素</span></span>
        Element rootElement = doc.getRootElement();
        dom4jElementToMap(<span class="hljs-built_in">map</span>, rootElement);
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">map</span>;
    }


    <span class="hljs-comment">/***
     * <span class="zh-hans">相同节点会全部解析出来。</span>
     * <span class="zh-hans">使用递归调用将多层级</span>xml<span class="zh-hans">转为</span>map
     * @param map
     * @param rootElement
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> dom4jElementToMap(Map&lt;<span class="hljs-keyword">String</span>, <span class="hljs-keyword">Object</span>&gt; <span class="hljs-built_in">map</span>, Element rootElement) {
        <span class="hljs-comment">//<span class="zh-hans">获得当前节点的子节点</span></span>
        List&lt;Element&gt; elements = rootElement.elements();
        <span class="hljs-keyword">if</span> (elements.<span class="hljs-built_in">size</span>() == <span class="hljs-number">0</span>) {
            <span class="hljs-comment">//<span class="zh-hans">没有子节点说明当前节点是叶子节点，直接取值</span></span>
            <span class="hljs-built_in">map</span>.put(rootElement.getName(), rootElement.getText());
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (elements.<span class="hljs-built_in">size</span>() == <span class="hljs-number">1</span>) {
            <span class="hljs-comment">//<span class="zh-hans">只有一个子节点说明不用考虑</span>list<span class="zh-hans">的情况，继续递归</span></span>
            Map&lt;<span class="hljs-keyword">String</span>, <span class="hljs-keyword">Object</span>&gt; tempMap = <span class="hljs-keyword">new</span> <span class="hljs-keyword">HashMap</span>();
            dom4jElementToMap(tempMap, elements.<span class="hljs-built_in">get</span>(<span class="hljs-number">0</span>));
            <span class="hljs-keyword">if</span> (tempMap.<span class="hljs-built_in">get</span>(rootElement.getName()) != <span class="hljs-keyword">null</span>) {
                <span class="hljs-built_in">map</span>.put(rootElement.getName(), tempMap.<span class="hljs-built_in">get</span>(rootElement.getName()));
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-built_in">map</span>.put(rootElement.getName(), tempMap);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">//<span class="zh-hans">多个子节点的话就要考虑</span>list<span class="zh-hans">的情况了，特别是当多个子节点有名称相同的字段时</span></span>
            Map&lt;<span class="hljs-keyword">String</span>, <span class="hljs-keyword">Object</span>&gt; tempMap = <span class="hljs-keyword">new</span> <span class="hljs-keyword">HashMap</span>();
            <span class="hljs-keyword">for</span> (Element element : elements) {
                tempMap.put(element.getName(), <span class="hljs-keyword">null</span>);
            }
            Set&lt;<span class="hljs-keyword">String</span>&gt; keySet = tempMap.keySet();
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">String</span> string : keySet) {
                Namespace namespace = elements.<span class="hljs-built_in">get</span>(<span class="hljs-number">0</span>).getNamespace();
                List&lt;Element&gt; sameElements = rootElement.elements(<span class="hljs-keyword">new</span> QName(string, namespace));
                <span class="hljs-comment">//<span class="zh-hans">如果同名的数目大于</span>1<span class="zh-hans">则表示要构建</span>list</span>
                <span class="hljs-keyword">if</span> (sameElements.<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">1</span>) {
                    List&lt;Map&gt; list = <span class="hljs-keyword">new</span> ArrayList();
                    <span class="hljs-keyword">for</span> (Element element : sameElements) {
                        Map&lt;<span class="hljs-keyword">String</span>, <span class="hljs-keyword">Object</span>&gt; sameTempMap = <span class="hljs-keyword">new</span> <span class="hljs-keyword">HashMap</span>();
                        dom4jElementToMap(sameTempMap, element);
                        list.<span class="hljs-built_in">add</span>(sameTempMap);
                    }
                    <span class="hljs-built_in">map</span>.put(string, list);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">//<span class="zh-hans">同名的数量不大于</span>1<span class="zh-hans">直接递归</span></span>
                    Map&lt;<span class="hljs-keyword">String</span>, <span class="hljs-keyword">Object</span>&gt; sameTempMap = <span class="hljs-keyword">new</span> <span class="hljs-keyword">HashMap</span>();
                    dom4jElementToMap(sameTempMap, sameElements.<span class="hljs-built_in">get</span>(<span class="hljs-number">0</span>));
<span class="hljs-comment">//                    map.put(string, sameTempMap.get(string));</span>
                    <span class="hljs-keyword">if</span> (sameTempMap.<span class="hljs-built_in">get</span>(string) != <span class="hljs-keyword">null</span>) {
                        <span class="hljs-built_in">map</span>.put(string, sameTempMap.<span class="hljs-built_in">get</span>(string));
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-built_in">map</span>.put(string, sameTempMap);
                    }
                }
            }
        }
    }
</code></pre><blockquote data-source-line="830">
<p>这段代码就复杂了，递归解析</p>
</blockquote>
<p data-source-line="833">JSON解析工具当然首选fastjson</p>
<p data-source-line="835">至此理念中的第2步、第3步实现了</p>
<p data-source-line="837"><strong>解析流程</strong></p>
<p data-source-line="839"><img data-src="https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F7488232-51f09bac50af4cbb.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240" alt="image.png" src="https://upload-images.jianshu.io/upload_images/7488232-51f09bac50af4cbb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&amp;ynotemdtimestamp=1586765592464" data-processed="https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F7488232-51f09bac50af4cbb.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240"></p>
<p data-source-line="842"><strong>代码实现</strong></p>
<p data-source-line="844">这里以XML转JSON为例</p>
<pre data-source-line="845"><code class="hljs">    <span class="hljs-comment">/**
     * <span class="zh-hans">根据配置</span> xml <span class="zh-hans">转</span> json <span class="zh-hans">字符串</span>
     *
     * @param origin <span class="zh-hans">原始报文</span>
     * @param index  <span class="zh-hans">报文配置索引</span>
     * @return <span class="zh-hans">解析后的报文</span>
     */</span>
    public String xml<span class="hljs-constructor">ToJsonString(String <span class="hljs-params">origin</span>, String <span class="hljs-params">index</span>)</span> throws RuntimeException {
        <span class="hljs-comment">//<span class="zh-hans">结果</span>Map</span>
        Map&lt;String, Object&gt; resultMap = parse<span class="hljs-constructor">Object(<span class="hljs-params">origin</span>, <span class="hljs-params">index</span>, MessageAdapterConstant.XML, MessageAdapterConstant.JSON)</span>;

        <span class="hljs-comment">//<span class="zh-hans">转换成</span>JSON</span>
        return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JSONObject</span>.</span></span><span class="hljs-keyword">to</span><span class="hljs-constructor">JSONString(<span class="hljs-params">resultMap</span>)</span>;
    }
</code></pre><blockquote data-source-line="861">
<p>方法中的第一行实现了根据配置解析转换成目标数据Map，第二部转换成JSON数据</p>
</blockquote>
<p data-source-line="864">深究一下parseObject这个方法</p>
<pre data-source-line="865"><code class="hljs"><span class="hljs-comment">/**
     * <span class="zh-hans">将原始报文解析成</span>Object
     *
     * @param origin <span class="zh-hans">原始报文</span>
     * @param index  <span class="zh-hans">报文配置索引</span>
     * @param from   <span class="zh-hans">源格式</span>
     * @param to     <span class="zh-hans">目标格式</span>
     * @return Object
     */</span>
    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; parse<span class="hljs-constructor">Object(String <span class="hljs-params">origin</span>, String <span class="hljs-params">index</span>, String <span class="hljs-params">from</span>, String <span class="hljs-params">to</span>)</span> throws RuntimeException {
        <span class="hljs-comment">//<span class="zh-hans">获取配置</span></span>
        Map&lt;String, Map&lt;String, Object&gt;&gt; messageConfig = configFileLoader.get<span class="hljs-constructor">MessageConfig()</span>;

        <span class="hljs-comment">//<span class="zh-hans">获取该报文解析配置详情</span></span>
        Map&lt;String, Object&gt; transformMap = messageConfig.get(index + <span class="hljs-string">"_"</span> + from + <span class="hljs-string">"_"</span> + <span class="hljs-keyword">to</span>);

        <span class="hljs-keyword">if</span> (transformMap<span class="hljs-operator"> == </span>null) {
            throw <span class="hljs-keyword">new</span> <span class="hljs-constructor">RuntimeException(<span class="hljs-string">"<span class="zh-hans">配置文件缺失！</span>:"</span> + <span class="hljs-params">index</span> + <span class="hljs-string">" "</span> + <span class="hljs-params">from</span> + <span class="hljs-string">" "</span> + <span class="hljs-params">to</span>)</span>;
        }

        Boolean isWithList = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Boolean</span>.</span></span>value<span class="hljs-constructor">Of((String)</span> transformMap.get(<span class="hljs-string">"isWithList"</span>));

        <span class="hljs-comment">//<span class="zh-hans">将原始数据转换成</span>MAP</span>
        Map&lt;String, Object&gt; originData = <span class="hljs-keyword">new</span> HashMap&lt;&gt;<span class="hljs-literal">()</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageAdapterConstant</span>.</span><span class="hljs-module"><span class="hljs-identifier">JSON</span>.</span></span>equals(from)) {
            originData = (Map&lt;String, Object&gt;) <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JSONObject</span>.</span></span>parse<span class="hljs-constructor">Object(<span class="hljs-params">origin</span>, Map.<span class="hljs-params">class</span>)</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageAdapterConstant</span>.</span><span class="hljs-module"><span class="hljs-identifier">XML</span>.</span></span>equals(from)<span class="hljs-operator"> &amp;&amp; </span><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Optional</span>.</span></span><span class="hljs-keyword">of</span><span class="hljs-constructor">Nullable(<span class="hljs-params">isWithList</span>)</span>.<span class="hljs-keyword">or</span><span class="hljs-constructor">Else(<span class="hljs-params">false</span>)</span>) {
            originData = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">XmlUtil</span>.</span></span>dom4j<span class="hljs-constructor">XmlToMap(<span class="hljs-params">origin</span>)</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageAdapterConstant</span>.</span><span class="hljs-module"><span class="hljs-identifier">XML</span>.</span></span>equals(from)<span class="hljs-operator"> &amp;&amp; </span>!<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Optional</span>.</span></span><span class="hljs-keyword">of</span><span class="hljs-constructor">Nullable(<span class="hljs-params">isWithList</span>)</span>.<span class="hljs-keyword">or</span><span class="hljs-constructor">Else(<span class="hljs-params">false</span>)</span>) {
            originData = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">XmlUtil</span>.</span></span>parse<span class="hljs-constructor">XmlToMap(<span class="hljs-params">origin</span>)</span>;
        }

        <span class="hljs-comment">//<span class="zh-hans">获取转换配置详情</span></span>
        List&lt;Map&lt;String, Object&gt;&gt; transformDetails = (List&lt;Map&lt;String, Object&gt;&gt;) transformMap.get(<span class="hljs-string">"details"</span>);

        <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CollectionUtils</span>.</span></span>is<span class="hljs-constructor">Empty(<span class="hljs-params">transformDetails</span>)</span>) {
            <span class="hljs-comment">//<span class="zh-hans">没有配置详情，则全转</span></span>
            return originData;
        }

        <span class="hljs-comment">//<span class="zh-hans">结果</span></span>
        Map&lt;String, Object&gt; resultMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;<span class="hljs-literal">()</span>;

        <span class="hljs-comment">//<span class="zh-hans">针对每一个配置解析</span></span>
        for (Map&lt;String, Object&gt; transformDetail : transformDetails) {
            parse(transformDetail, resultMap, originData);
        }
        return resultMap;
    }
</code></pre><blockquote data-source-line="916">
<p>上面完成的是获取配置文件，将XML数据（源数据）转换成java map，最后根据配置文件中的每一个配置进行解析转换。</p>
</blockquote>
<p data-source-line="918">再深究一下parse找个方法，这个是递归解析的核心方法.</p>
<pre data-source-line="919"><code class="hljs"><span class="hljs-comment">/**
     * <span class="zh-hans">解析</span>
     *
     * @param transformDetail
     */</span>
    <span class="hljs-keyword">private</span> void parse(Map&lt;String, Object&gt; transformDetail, Map&lt;String, Object&gt; resultMap, Object originData) throws RuntimeException {
        <span class="hljs-comment">//<span class="zh-hans">源属性类型</span></span>
        String originType = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Optional</span>.</span></span><span class="hljs-keyword">of</span><span class="hljs-constructor">Nullable((String)</span> transformDetail.get(<span class="hljs-string">"originType"</span>)).<span class="hljs-keyword">or</span><span class="hljs-constructor">Else(MessageAdapterConstant.DataType.STRING)</span>;
        <span class="hljs-comment">//<span class="zh-hans">普通的源数据和目标数据转换</span></span>
        <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">StringUtils</span>.</span></span>is<span class="hljs-constructor">NotBlank(<span class="hljs-params">originType</span>)</span><span class="hljs-operator"> &amp;&amp; </span>!<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageAdapterConstant</span>.</span><span class="hljs-module"><span class="hljs-identifier">DataType</span>.</span><span class="hljs-module"><span class="hljs-identifier">COMPOSITE</span>.</span></span>equals(originType)<span class="hljs-operator"> &amp;&amp; </span>!<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageAdapterConstant</span>.</span><span class="hljs-module"><span class="hljs-identifier">DataType</span>.</span><span class="hljs-module"><span class="hljs-identifier">LIST</span>.</span></span>equals(originType)) {
            <span class="hljs-comment">//<span class="zh-hans">获取源数据存放的目标位置</span></span>
            String target = (String) transformDetail.get(<span class="hljs-string">"target"</span>);
            <span class="hljs-comment">//<span class="zh-hans">获取源数据存放位置</span>,</span>
            String origin = (String) transformDetail.get(<span class="hljs-string">"origin"</span>);

            <span class="hljs-comment">//<span class="zh-hans">目标属性类型</span></span>
            String targetType = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Optional</span>.</span></span><span class="hljs-keyword">of</span><span class="hljs-constructor">Nullable((String)</span> transformDetail.get(<span class="hljs-string">"targetType"</span>)).<span class="hljs-keyword">or</span><span class="hljs-constructor">Else(MessageAdapterConstant.DataType.STRING)</span>;

            <span class="hljs-comment">//<span class="zh-hans">如果是日期类型的话需要获取日期格式</span></span>
            <span class="hljs-comment">//<span class="zh-hans">源属性数据类型格式</span></span>
            String originDateFormat = (String) transformDetail.get(<span class="hljs-string">"originDateFormat"</span>);
            <span class="hljs-comment">//<span class="zh-hans">目标数据类型格式</span></span>
            String targetDateFormat = (String) transformDetail.get(<span class="hljs-string">"targetDateFormat"</span>);

            <span class="hljs-comment">//<span class="zh-hans">获取源数据</span></span>
            String originContent = get<span class="hljs-constructor">OriginContent(<span class="hljs-params">origin</span>, <span class="hljs-params">originData</span>)</span>;

            <span class="hljs-comment">//<span class="zh-hans">将源数据根据配置设置到结果值</span></span>
            set<span class="hljs-constructor">ResultContent(<span class="hljs-params">resultMap</span>, <span class="hljs-params">target</span>, <span class="hljs-params">originContent</span>, <span class="hljs-params">originType</span>, <span class="hljs-params">targetType</span>, <span class="hljs-params">originDateFormat</span>, <span class="hljs-params">targetDateFormat</span>)</span>;
            return;
        }

        <span class="hljs-comment">//<span class="zh-hans">如果是复杂类型数据（一个源数据解析出好几个数据）</span>,<span class="zh-hans">需要递归获取</span></span>
        <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">StringUtils</span>.</span></span>is<span class="hljs-constructor">NotBlank(<span class="hljs-params">originType</span>)</span><span class="hljs-operator"> &amp;&amp; </span><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageAdapterConstant</span>.</span><span class="hljs-module"><span class="hljs-identifier">DataType</span>.</span><span class="hljs-module"><span class="hljs-identifier">COMPOSITE</span>.</span></span>equals(originType)) {
            <span class="hljs-comment">//<span class="zh-hans">获取子转换规则</span></span>
            List&lt;Map&lt;String, Object&gt;&gt; childDetails = (List&lt;Map&lt;String, Object&gt;&gt;) transformDetail.get(<span class="hljs-string">"details"</span>);
            <span class="hljs-comment">//<span class="zh-hans">获取源数据存放位置</span></span>
            String origin = (String) transformDetail.get(<span class="hljs-string">"origin"</span>);
            <span class="hljs-comment">//<span class="zh-hans">获取源数据</span></span>
            String originContent = get<span class="hljs-constructor">OriginContent(<span class="hljs-params">origin</span>, <span class="hljs-params">originData</span>)</span>;
            <span class="hljs-comment">//<span class="zh-hans">获取数据分割类型</span></span>
            String splitType = (String) transformDetail.get(<span class="hljs-string">"splitType"</span>);
            <span class="hljs-comment">//<span class="zh-hans">源数据列表</span></span>
            List&lt;String&gt; originContentList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;<span class="hljs-literal">()</span>;

            <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageAdapterConstant</span>.</span><span class="hljs-module"><span class="hljs-identifier">SplitType</span>.</span><span class="hljs-module"><span class="hljs-identifier">SEPARATOR</span>.</span></span>equals(splitType)) {
                <span class="hljs-comment">//<span class="zh-hans">获取分割符</span></span>
                String separator = (String) transformDetail.get(<span class="hljs-string">"separator"</span>);
                <span class="hljs-comment">//<span class="zh-hans">数据分割</span></span>
                originContentList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Arrays</span>.</span></span><span class="hljs-keyword">as</span><span class="hljs-constructor">List(<span class="hljs-params">originContent</span>.<span class="hljs-params">split</span>(<span class="hljs-params">separator</span>)</span>));
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageAdapterConstant</span>.</span><span class="hljs-module"><span class="hljs-identifier">SplitType</span>.</span><span class="hljs-module"><span class="hljs-identifier">LOCATION</span>.</span></span>equals(splitType)) {
                <span class="hljs-comment">//<span class="zh-hans">获取取位配置</span></span>
                String locations = (String) transformDetail.get(<span class="hljs-string">"locations"</span>);
                <span class="hljs-comment">//<span class="zh-hans">解析</span></span>
                String<span class="hljs-literal">[]</span> locationArray = locations.split(<span class="hljs-string">","</span>);
                for (String location : locationArray) {
                    <span class="hljs-built_in">int</span> beginIndex = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Integer</span>.</span></span>parse<span class="hljs-constructor">Int(<span class="hljs-params">location</span>.<span class="hljs-params">split</span>(<span class="hljs-string">"-"</span>)</span><span class="hljs-literal">[<span class="hljs-number">0</span>]</span>);
                    <span class="hljs-built_in">int</span> endIndex = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Integer</span>.</span></span>parse<span class="hljs-constructor">Int(<span class="hljs-params">location</span>.<span class="hljs-params">split</span>(<span class="hljs-string">"-"</span>)</span><span class="hljs-literal">[<span class="hljs-number">1</span>]</span>);
                    originContentList.add(originContent.substring(beginIndex, endIndex));
                }
            }
            <span class="hljs-comment">//<span class="zh-hans">解析</span></span>
            for (Map&lt;String, Object&gt; childDetail : childDetails) {
                parse(childDetail, resultMap, originContentList);
            }
            return;
        }
        
        <span class="hljs-comment">//<span class="zh-hans">如果源数据是列表数据</span></span>
        <span class="hljs-keyword">if</span> (<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">StringUtils</span>.</span></span>is<span class="hljs-constructor">NotBlank(<span class="hljs-params">originType</span>)</span><span class="hljs-operator"> &amp;&amp; </span><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageAdapterConstant</span>.</span><span class="hljs-module"><span class="hljs-identifier">DataType</span>.</span><span class="hljs-module"><span class="hljs-identifier">LIST</span>.</span></span>equals(originType)) {
            <span class="hljs-comment">//<span class="zh-hans">获取子转换规则</span></span>
            List&lt;Map&lt;String, Object&gt;&gt; childDetails = (List&lt;Map&lt;String, Object&gt;&gt;) transformDetail.get(<span class="hljs-string">"details"</span>);
            <span class="hljs-comment">//<span class="zh-hans">获取源数据存放位置</span></span>
            String origin = (String) transformDetail.get(<span class="hljs-string">"origin"</span>);
            <span class="hljs-comment">//<span class="zh-hans">获取目标数据存放位置</span></span>
            String target = (String) transformDetail.get(<span class="hljs-string">"target"</span>);
            <span class="hljs-comment">//<span class="zh-hans">目标属性类型</span></span>
            String targetType = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Optional</span>.</span></span><span class="hljs-keyword">of</span><span class="hljs-constructor">Nullable((String)</span> transformDetail.get(<span class="hljs-string">"targetType"</span>)).<span class="hljs-keyword">or</span><span class="hljs-constructor">Else(MessageAdapterConstant.DataType.STRING)</span>;
            <span class="hljs-comment">//<span class="zh-hans">获取源数据</span></span>
            List&lt;Map&lt;String, Object&gt;&gt; originListContent = get<span class="hljs-constructor">OriginListContent(<span class="hljs-params">origin</span>, <span class="hljs-params">originData</span>)</span>;

            <span class="hljs-comment">//<span class="zh-hans">结果列表</span></span>
            List&lt;Map&lt;String, Object&gt;&gt; resultList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;<span class="hljs-literal">()</span>;
            for (Object originChildMap : originListContent) {
                <span class="hljs-comment">//<span class="zh-hans">解析</span></span>
                Map&lt;String, Object&gt; targetChildMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;<span class="hljs-literal">()</span>;
                resultList.add(targetChildMap);
                for (Map&lt;String, Object&gt; childDetail : childDetails) {
                    parse(childDetail, targetChildMap, originChildMap);
                }
            }
            <span class="hljs-comment">//<span class="zh-hans">设置列表解析结果</span></span>
            set<span class="hljs-constructor">ResultContent(<span class="hljs-params">resultMap</span>, <span class="hljs-params">target</span>, <span class="hljs-params">resultList</span>, <span class="hljs-params">originType</span>, <span class="hljs-params">targetType</span>, <span class="hljs-params">null</span>, <span class="hljs-params">null</span>)</span>;
        }
    }
</code></pre><blockquote data-source-line="1016">
<p>这里完成的是根据详细配置解析转换成目标数据，可谓是相当复杂，
其他方法就不一一列举了，贴代码其实是浪费篇幅，太复杂，不能完全讲清楚。</p>
</blockquote>
<h4 id="总结" data-source-line="1019"><a class="markdownIt-Anchor" href="#总结"></a>总结</h4>
<p data-source-line="1021">篇幅有点长，代码有点多，不必细看，主要介绍的还是我们常用的数据解析工具，拓展应用只是提供参考，其中XML-JSON相互转换有提供详细设计,</p>
</div></article><body></body></html>